**2018.01.02**
http://www.ftchinese.com/m/corp/preview.html?pageid=EditorChoice-20180102
console.log (jsonUrl);       /falcon.php/pagemaker/get/EditorChoice/2018-1-2?174737
https://apis.google.com/js/client:platform.js

**2018.01.03**
```
https://www.jianshu.com/p/1ef61a785508   苹果IAP(内购)中沙盒账号使用注意事项
   function insertText(obj,str) {
        if (document.selection) {        
            var sel = document.selection.createTextRange();
            sel.text = str;
        } else if (typeof obj.selectionStart === 'number' && typeof obj.selectionEnd === 'number') {
            var startPos = obj.selectionStart,
                endPos = obj.selectionEnd,
                cursorPos = startPos,
                tmpStr = obj.value;
            obj.value = tmpStr.substring(0, startPos) + str + tmpStr.substring(endPos, tmpStr.length);
            cursorPos += str.length;
            obj.selectionStart = obj.selectionEnd = cursorPos;
        } else {
             obj.value += str;
        }
    }
```
**2018.01.13**
###CMS  Workflow
+ News List  ： /Users/huiyun/hhy/webproject/dev_cms/libs/smarty/templates/workflow/newslist.html
```
<a href="/falcon.php/workflow/downloadnewslist/<%$files.newslist_id%>">  下载文档的功能
<a href="/falcon.php/workflow/delnewslist/<%$files.newslist_id%>">  删除新闻列表

```
+ 作者名录：/Users/huiyun/hhy/webproject/dev_cms/libs/smarty/templates/workflow/admin_author_list.html
   ``` 
    <form id="search_form" name="search_form" action="/falcon.php/workflow/admin_author_list" method="GET">
```
+ 等待终审：/Users/huiyun/hhy/webproject/dev_cms/libs/smarty/templates/workflow/approved_list.html
   ``` 
    <a href="/falcon.php/workflow/view/<%$re.articleid%>"><%$re.eheadline%></a>
```
+ 等待校对：/Users/huiyun/hhy/webproject/dev_cms/libs/smarty/templates/workflow/edited_list.html
+ 编辑稿件：/Users/huiyun/hhy/webproject/dev_cms/libs/smarty/templates/workflow/edit.html
+ 城市名单：/Users/huiyun/hhy/webproject/dev_cms/libs/smarty/templates/workflow/set_translat_cityname.html
+ 统计： /Users/huiyun/hhy/webproject/dev_cms/libs/smarty/templates/workflow/workcount.html
  ``` 
<form id="search_form" name="search_form" action="/falcon.php/workflow/workcount" method="get">
    ```
+稿件操作日志：/Users/huiyun/hhy/webproject/dev_cms/libs/smarty/templates/workflow/view_logs.html
在编辑的log中
+ 归档：/Users/huiyun/hhy/webproject/dev_cms/libs/smarty/templates/workflow/view_archives.html
在编辑的archives中

+ 名词解释：/Users/huiyun/hhy/webproject/dev_cms/libs/smarty/templates/glossary/index.html
+ 名词解释（beta）:/Users/huiyun/hhy/webproject/dev_cms/libs/cms_app/app/model/glossary/GlossaryModel.js
   /Users/huiyun/hhy/webproject/dev_cms/libs/cms_app/app/store/glossary/GlossaryStore.js
   Ext.define('CMS.store.glossary.GlossaryStore', {

**2018.01.18**
```
   {
  "presets": [
    ["latest", {
      "es2015": {
        "modules": false
      }
    }]
  ],
  "plugins": ["external-helpers"]
}
```
**2018.01.21**
```
gulp.task('build-page', () => {
  const env = {
    isProduction: process.env.NODE_ENV === 'production'
  };
  // return renderSub('index.html', './views/data/data.json')
  return loadJsonFile('./views/data/data.json')
    .then(data => {
      return render('index.html', {//此对象是传给html使用的，context
        products: data,
        env
      });
    })
    .then(html => {
// If `production`, inline css and js   
      if (process.env.NODE_ENV === 'production') {
        return inline(html, {
          compress: true,
          rootpath: path.resolve(process.cwd(), '.tmp')
        });
      }    
      return html;
    })
    .then(html => {
      return fs.writeAsync('.tmp/index.html', html);
    })
    .then(() => {
      browserSync.reload('*.html');
      return Promise.resolve();
    })
    .catch(err => {
      console.log(err);
    });
});

function renderSub(template, json) {
  const env = {
    isProduction: process.env.NODE_ENV === 'production'
  };
  return loadJsonFile(json)
    .then(data => {
      return render(template, {//此对象是传给html使用的，context
        products: data,
        env
      });
    })
}
```

```
      // context={
      //     products: data,
      //     env
      // }
      // // 此处是development ，运行完dev和build才运行此处，why？
      // return render(template, context);

           return loadJsonFile(dataPath)
      .then(data => {
        console.log('inline--'+process.env.NODE_ENV)
        return render(template, {
          products: data,
          env
        });
      })

  async function renderHtml(template,dataPath,env) {
  let context = {}
  if (dataPath ==='views/data/data.json'){
    // 此处是production
    return loadJsonFile(dataPath)
    .then(data => {
      // 此处是development
      return render(template, {
        products: data,
        env
      });
    })
  }else{
    // 此处是production
    context = {env}
    return render(template, context)
  }
  
}
```

**2018.01.22**

```
    function isWeiXin() {
        var ua = window.navigator.userAgent.toLowerCase();
        console.log(ua);
        //mozilla/5.0 (iphone; cpu iphone os 9_1 like mac os x) applewebkit/601.1.46 (khtml, like gecko)version/9.0 mobile/13b143 safari/601.1
        if (ua.match(/MicroMessenger/i) == 'micromessenger') {
            return true;
        } else {
            return false;
        }
    }

    if(isWeiXin()){
        console.log(" 是来自微信内置浏览器")
    }else{
        console.log("不是来自微信内置浏览器")
    }

    /Users/huiyun/hhy/webproject/NEXT/app/templates/partials/QrCode.html



**2018.01.23**

var storyBodyClass = document.getElementsByClassName('story-body');
var storyBody = document.querySelectorAll('.story-body');
var storyBodyId = document.getElementById('story-body');

<!--<div id="payment-page">
    <div id="payment-shadow" class="o-overlay-shadow"></div>
    <div id="payment-box" >
        <div class="payment-title">欢迎订阅FT会员服务</div>
    </div>
</div>-->

ios分享url
ShareHelper.shared.webPageUrl = "\(Share.base)\(item.type)/\(item.id)?full=y#ccode=\(Share.CampaignCode.actionsheet)"

**2018.01.25**
<!--<button class="subscribe-btn">立即订阅▶︎</button>-->
<button class="subscribe-btn"><a href="http://www.ftchinese.com/startapp.html?<%$story.id%>" >立即订阅▶︎</a></button>

**2018.01.29**
```
<div class="subscribe-lock-container" id="ios-device">
    <div class="lock-content">
      <div class="lock-text lock-title">购买会员服务，阅读FT独家内容</div>
      <button class="subscribe-btn"><a href="http://www.ftchinese.com/startapp.html?" >app内打开</a></button>
    </div>
</div>  

<div class="subscribe-lock-container" id="web-type">
    <div class="lock-content">
      <div class="lock-text">
        <div class="lock-text">使用FT中文网iOS应用，成为付费会员，阅读FT独家内容。</div>
        <div class="lock-text lock-download-hint"><span>可下载iOS App购买</span></div>
    <!--<div class="app-download-code">
          <img src="http://static.ftchinese.com/img/download-ios-app.jpg"/>
      </div>-->
      </div>
      <button class="subscribe-btn"><a href="/" >打开首页▶︎</a></button>
    </div>
</div>  

function getDeviceSpecie() {
    var searchVars = {};
    if (window.location.search.length > 1) {
        var searchStr = window.parent.location.search;
        for (var oneKeyValueArr, index = 0, searchStrArr = searchStr.substr(1).split('&'); index < searchStrArr.length; index++) {
        oneKeyValueArr = searchStrArr[index].split('=');
        searchVars[decodeURIComponent(oneKeyValueArr[0])] = oneKeyValueArr.length > 1 ? decodeURIComponent(oneKeyValueArr[1]) : '';
        }
    }
    var uaString = navigator.userAgent || navigator.vendor || '';
    var deviceType = 'PC';
  
    if (/iPad/i.test(uaString)) {
      deviceType = 'PadWeb';
      if(searchVars.webview && searchVars.webview === 'ftcapp') {
        deviceType = 'PadApp';
      }
    } else if (/OS [0-9]+\_/i.test(uaString) && (/iPhone/i.test(uaString) || /iPod/i.test(uaString))) {
      deviceType = 'iPhoneWeb';
      if(searchVars.webview && searchVars.webview === 'ftcapp') {
        deviceType = 'iPhoneApp';
      }
    } else if (/Android|micromessenger/i.test(uaString) ) {
      deviceType = 'AndroidWeb';
    }
    return deviceType;
}
// MARK:The subscription product displays different contents according to different devices.
var deviceSpecie = getDeviceSpecie();
var iosDevice = document.getElementById('ios-device');
var webType = document.getElementById('web-type');
if(deviceSpecie === 'PadWeb'|| deviceSpecie === 'PadApp'|| deviceSpecie === 'iPhoneApp'||deviceSpecie === 'iPhoneWeb') {
    webType.style.display = 'none';
    iosDevice.style.display = 'block';
}else{
    webType.style.display = 'block';
    iosDevice.style.display = 'none';
}

    //   background: linear-gradient(rgba(255,241,225,0.3),rgba(255,241,225,1),rgba(255,241,225,1));
    .lock-content{
  height:30px;
  line-height: 30px;
      width: 100%;
      text-align: center;
    position: relative;
    height: 60%;
    top: 20%;
    }
        .lock-text{
      text-align: center;
    .lock-title{
      height: 40%;
    }
    span{
      padding-left: 2px;
      color:#0d7680;
    }
    }
      //   &:hover, &:active {
  //  background-color: rgba(39, 117, 123, 1);
  //  border-color: rgba(39, 117, 123, 1);  
  //   }
      .app-download-code{
    text-align: center;
    padding: 10px 0 20px;
    img{
      width: 150px;
    }
    }
        .sub-container span{
      color: #0d7680;
    }
```
**2018.01.30**
```
    知乎js：
    v = function() {
        r.a.Android && !h && (!r.a.Zhihu || /^zhihu:\/\/pin\/(daily|special)\/\d+/.test(l) && r.a.ZhihuAndroidVersionMajor >= 5) && (location.href = l)
    }
    m(v)
```

```
    v = function() {
          (11) && (location.href = iosUrl)
          // location.href='https://www.baidu.com/'
          // (11)&&(location.href='ftchinese://')
          console.log("执行函数")
    }
    m = function(e) {
    var n = new Image;
    var t = 'https://api.zhihu.com/channel/internal/link?utm_source=wechat_session';
      n.onload = e, 
      n.src = t
      setTimeout(e, 500)
      
    }
  m(v)
  如果仅仅加载n.onload = e, n.src = t，则不会运行e，setTimeout(e, 500)会运行e，这是为什么？
  setTimeout应该是让页面先加载完，再运行e，这样就不会一直先弹出错误信息。

  function iframeWay(){
      var ifr = document.createElement("iframe");
      ifr.style.width = 0;
      ifr.style.height = 0;
      ifr.style.display = 'none';
      ifr.src = iosUrl; 
      document.body.appendChild(ifr);
      console.log("执行函数1");
 }
 iframe方法手机浏览器不执行跳转到其它页面。

 iframe方法不会引起页面可见的变化（例如页面内容变成一个新页面），不会导致浏览器历史记录的变化。

 浏览器启动app问题：https://segmentfault.com/q/1010000003838966
 
 iOS9 Universal Links 
  ```