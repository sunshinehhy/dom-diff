**2019.2.15**

1. 编辑，检验是否重复，还得考虑上下同时变动 1 完
2. 图片更换（重新传图片） 0.5 完
3. 第一条默认显示 完
4. 进度条显示精度 我认为可以不做
5. 加上进度条上当前播放时间 完
6. 始终时间以起始时间为打点 完
7. 点击进度条上的点，滚动到可视区内（并且加亮） 完
8. 假如 2 个空格有空，播放按钮就不可以点 完
9. 进度条上打点可能重叠 不用考虑
10. 检查为什么最后一条数据会经常消失
11. 鼠标移动操作 完
12. 当同时插入多条数据，执行删除，上一条终和下一条始需要对应上 完
13. 第一条和最后一条不允许删除 完
14. 输入框去除前后空格 完
15. 加入标题 完
16. isCheckPlaypush 时候需要初始化 完
17. 当正在播放的时候，再插入一条，当点击打点时候，需要把回放的音频停止 完
18. 打点和删除还有些问题，仔细检查（第一个和第二个之间打点有问题） 完
19. 拖进度条之后释放，没有继续播放 完
20. 删除最后一条和第一条出现的问题 完
21. 打点的图片 bug
22. 一段时间要自动提交保存吗？让产品看看效果？删除时候图片的更新？是否默认第一条变激活状态？聚焦输入框？进度条拖动是否需要播放问题（要问）
23. 上传边界
24. 写提测清单
25. 按钮添加 完
26. 默认第一张 完
27. 拖拽暂停播放 完
28. 默认保存（cookie）
29. 删除后的样式
30. 上传图片的本地保存文件名 完
31. 提交时，要全部正确，才能 pop，也就是不传最后一个 完
32. 删除第一条，需要把第一个值变成 0.0 完
33. 当停下来打点，有 1s 之差
34. 最后一个修改不能操作音频时长 完
35. 从后删除 完
36. 控件修改 完
37. 返回加二次确定 完
38. 回到第一次修改的值
39. 当点击回播确定，然后点击播放，需要获取进度条的值，然后从进度条开始播放，不能从回放的地方播，不然获取的秒点位置会出错
40. 播放转到第一条，播放开始时间应该切换
41. 删除和打点还是需要更新 this.focusInputValue。
    当删除需要区分起始值。强制在修改的时候， 不能删除。
42. 当播放下面的，重新点击锚点，需要停止之前播放的，再重新开始播

http://localhost:8888/courseCourseList/courseCourseSectionDot?productPid=247152453729869824&type=200&audioUrl=https%3A%2F%2Fcoolcdn.igetcool.com%2Ft%2Faudio%2F20180920%2F1537429895615_48.m4a&audioName=12321 音频短

现象：当播放后，canplay 还会触发
that.player.addEventListener('canplay',function (e) {})

watch 当监听没有发生改变，就不会更新
this.form.type 更新已经有的参数，watch 会监听，如果添加新的字段，watch 不会监听

http://michaelnthiessen.com/force-re-render/

editEndTimeDot(value,key){
this.form.points[key+1].startTimeDot = value;
// this.$set(this.form.points[key-1], 'endTimeDot', value)
    this.$forceUpdate()
}

        // that.player.addEventListener('timeupdate', () => {
    //   let duration = this.audioDuration;
    //   let currentTime = that.player.currentTime;
    //   let percentage = Math.ceil(100 * (currentTime / duration));

    //   if(!this.isCheckPlay[this.pieceOfAudioIndex]){
    //     that.seekTo(percentage, false);
    //     let currentTimeStr = that.formatTime(Math.ceil(currentTime));
    //     that.range.dataset.current = currentTimeStr;
    //     console.log('22');
    //   }

    //   let endTimeSecond = Util.formatDate.dateToSecond(this.form.points[this.pieceOfAudioIndex].endTimeDot);
    //   if(this.isCheckPlay[this.pieceOfAudioIndex] && Number(currentTime)>=endTimeSecond){
    //     this.isCheckPlay[this.pieceOfAudioIndex] = false;
    //     this.pause();
    //     console.log('11');
    //     that.player.removeEventListener('timeupdate',  () => {});
    //   }

    // });

that.player.addEventListener('canplay',function (e) {})
先执行下面，再执行上面

我再确定几个小细节，我先提前给你说一声，有时间再回我： 1.当前播放时间是写在左边（线上样式）还是要跟着进度条走动呢？（我建议写在左边，因为音频组件都统一是在左边，包括客户端 app 线上 h5 显示）； 2.进度条滑块和锚点的层级显示，之前跟你说过，你说进度条滑块可以遮住锚点，但是当离左边打点时间很短的情况下，不能看到锚点的位置（因为设计的滑块有一定的宽度，被滑块挡住了）

思路：（需要修改的地方：打点函数、最后一条不需要默认添加，默认是空，必须要上传图片）
默认第一条，是为了先上传图片，再打点。
打点自动填充到插入的之间。

获取当天的 12 点整毫秒数。
获取打开的年月日，年月日再拼
获取年月日
只要更改 point 的地方，就需要更新 cookie
当打开页面获取毫秒数，并且获取年月日，然后再获取年月日+0 点的毫秒数，取 2 者只差，是失效时间

let year = new Date().getFullYear() 2019
let month = new Date().getMonth() 1
let date = new Date().getDate() 18
let openCurrentPageTime = new Date().getTime();
if(month<9){
month = '0' + Number(month + 1)
}else{
month = month + 1
}

let timeStr = year+'-'+month+'-'+date + ' ' + '23:59:59'

let endTime = new Date(timeStr).getTime()
let expireTime = endTime - openCurrentPageTime

刚进入保存 cookie。

productPid 作为键名；
点击提交就删除 cookie；
一天可能就打点几次，所以存在 cookie 没问题，数据量不会很大；
不管是不是空，打开页面，就读取 cookie 中的值，如果没有 cookie 值就读取请求回来的值；（因为可能进入编辑过）
当编辑、打点、删除都需要更新 cookie

**2019.2.18**
todo:

1. cookie 的检查
2. 上传代码优化
3. 鼠标的操作
4. 打点精度
5. 样式调整
6. 上线小程序

```
<el-time-picker v-else
v-model="item.startTimeDot" @change="editStartTimeDot(key)"
value-format="HH:mm:ss"
placeholder="任意时间点"
:picker-options="{
    selectableRange: '18:30:00 - 20:30:00'
}">
</el-time-picker>
```

发现的 bug：最后一条能改，只要是新添加的参数就能改。从后台获取的是不能修改，这是为什么呢？
为什么只有最后一条能够修改成功

<div v-for="(item,key) in startTimes" v-bind:key="key">  
        <el-time-picker
        v-model="item.startTimeDot"
        value-format="HH:mm:ss"
        placeholder="任意时间点"
        >
      </el-time-picker>
    </div>

    <div v-for="(item,key) in startTimes" v-bind:key="key">
        <el-time-picker
        v-model="startTimes[key]"
        value-format="HH:mm:ss"
        placeholder="任意时间点"
        >
      </el-time-picker>
    </div>

computed 中不可以

当修改时，也需要考虑需不需要播放。

影响范围：
http://localhost:8888/homeStoryList 舰长广播
http://localhost:8888/homeNewList 地球电讯

http://localhost:8888/seriesListSingle/listenBookSectionList?seriesTitle=&bookPid=173660189612969984&bookTitle=%E5%A5%A5%E5%BE%B7%E4%BF%AE%E6%96%AF%E7%9A%84%E8%8B%B1%E9%9B%84%E4%BC%A0%E5%A5%87dsads&seriesPid=&pageBook=1&html=single 听书系列

http://localhost:8888/homeNewList/homeNewDot?productPid=208448260457426945&type=301&audioUrl=https%3A%2F%2Fcoolcdn.igetcool.com%2Ft%2Ffreenew%2Faudio%2F20180605%2F1528202117000_48.m4a&audioName=1234 2 个很接近的点实例

http://localhost:8888/bookSeriesList/listenBookAddEdit?seriesTitle=test&seriesPid=279379417542909952&pageSeries=1 有 Missing required prop: "value" 的 bug

季度奖金激励：
制度：

1. 文艺 ok，绩效考评
   季度奖金制度
   调薪 30%-50%，1 月份调薪。
   我是 T1 岗位
   okr
   T2 是 2-3 万 5
   T3 是 4 万以上
   明天总结正则表达式。
   /[0-9]/s

预约时间小于开课时间，公开课可以分享出去。
只针对公开课，直播课的不变。
分享链接是手填吗？
预约和推送通知

需要进入百家云教室。

普通页面还是分享记录页面，
填手机号领取了就算，不需要登录。假用户，领取。
分享记录。已购买的人数+符合购买的人数=符合购买的人数。
整个活动的倒计时，一个手机只能领取一次，代表注册了。
h5 页面会校验登录状态。
操作按钮需要点击登录，分享是个专属页面，是否同时增加购买，限制 3 个人。
第四个人，必须登录 app 才能领取。
用课来拉新效果。
活动结束时间来领。
有赞商城。
1 带 1
push 是自动的吗？还是手动的？领取成功之后再进入就还是这个页面。

新用户不能再拉新。时间结束，还是没人点，进入哪个页面？

没有判断用户，但是保存了手机。一个活动。是否是同一个商品。
不能领 2 个人的同一个。
都是老用户，填同一个手机号。

完成目标就不需要按钮，没有目标需要按钮。弹分享交互逻辑。如果完成就是都是已领取，已登录

分享出去没有规则。直接进入分享记录页
没有引导下载 app 的东西，在一起，上传活动规则图。

分享换一个微博。
活动结束，又卖又送。
匹配商品，不匹配页面。
初始领取不要了。

复述时间点，给估期时间点，确定人。
确定复述时间。

**2019.2.27**

- 今天跟产品确定会议上说的几个盲点，还有什么时候能写完需求文档，等那边确定了，能确定反述时间。
- 进一步确定谁做
- 估期
- 确定样式是否需要改变(胜辉)
- 登录是否确定为移动端
- 移动端版本是否是 1.4.5
- 再次进入，用什么来判断领取成功（微信账号吗？还是登录缓存？）
- 从发起者和新人角度说

需要确定点：

- 分割成几部分（分享页，CMS，h5，分享记录页）
- push 通知需要做吗？
- 设计做成什么样子？

根据现在追踪，暂定 3 月 1 号（没有 29 号），反述人员目前确定如下：
测试：全部参加
设计：全部参加
前端：何辉云（反述人）、吴振雪
后端：王若行
移动端：范文强、吴水方
产品：高珊

**2019.2.28**
分享免费听由我来反述，它的主要作用是为了引流、引新，裂变出更多的新人注册和浏览。
它需要在 h5 页面上做个升级，添加进入分享记录页的入口、分享和购买按钮、领取数量。

先说按钮逻辑：
这个页面包含可正价购买和不可正价购买，正价购买的样式是这样的：下面包含 2 个按钮，点击购买，走正常购买流程；点击分享弹出包含这些按钮，样式是蒙层。
不可正价购买是这样的。
如果版本不够，弹出立即升级。
分享后：**下面的是浮在上面吗？** **课程封面是 banner 图还是分享缩略图？**

限时 0 元领取，有多种情况，在正常情况下是触发 2 件事（进入页面、后台记录）、手机号需要校验。点击下载进入下载逻辑。
还有其他情况：当。。。

现在回到分享记录页的入口：

- 没人领取
- 一部分人领取
- 全部领取

**记录谁分享的？**
**记录领取时间？**
**记录是否登录过？**

- 应该添加一个字段，确定是不是此类活动页吗？
- 分享出去，进入分享业的图就不显示
- 分享记录页是添加生成的链接（在 app 中生成的链接在 web 中不能打开吧？）
- 如果结束了，不想要再有进入书房收听按钮吗？
- 进入书房、分享和购买，都是先进入登录流程吗？我看购买不是先进入登录。h5 活动页传的数据，在购买中也能获取到响应的参数吗？
- 活动时间要默认值
- 时间差值是左右闭环吗？
- 记录分享者与领取者的关系？这属于哪种关系？
- 商品名称是对应哪一个？
- 授权：同现有 H5 页面授权逻辑？

CMS h5 活动页继承了之前的规则。

最后面确定下样式问题。
还有什么问题吗？

5.  回归重点测试点

打点优化:

- 打点得出的区间顺序是否连续

- 删除起始点、中间点、末尾点，区间值是否连续，进度条上点是否正常

- 图是否显示正常

- 回播正常，并且互斥

- 拖拽进度条，会暂停

如果是一级菜单（一级导航）：

菜单 URL：驼峰命名的词

如果是二级菜单（二级导航）：

菜单 URL：/+驼峰命名的词

如果是三级菜单：包含中文名称、英文名称（驼峰命名的词）、Path（驼峰命名的词）
