# 2019 年 06 月 03 日

添加插件配置模板页面。
影响范围：

- 从分享免费听进入分享记录页判断版本
- 分享记录页判断版本
- 售卖页判断版本
- 所有活动页标题
- 分享免费听进入书房动作
- 语文售卖页请求获取用户状态是否正确
- 组合购买正常请求支付，组合购买是否能正常跳到登录，升级、版本判断、路由链接

### ua 和 web-native 交互函数影响点

组合购买：

- 137 版本以下页面是否正确、安卓还是 ios、app 内、app 外、
- 购买数据请求（doPost）
- 未登录，跳转到登录（jumpToLogin）

普通活动页：

- 137 版本功能是否正确、安卓和 ios 环境下 请求数据是否正确
- 测试是否能正常播放

H5 公开课：

- 137 版本功能是否正确、安卓和 ios 环境下 请求数据是否正确

1 期和 2 期语文售卖页：

- 151 版本以下，点击【一至四年级按钮】是否会弹出升级框
- 151 以上版本，是否能正常购买

分享免费听：

- 137 版本功能是否正确、安卓和 ios 环境下 请求数据是否正确
- ios 环境下 12.4 以下系统平台，微信中底层显示的浮框
- iosApp 和 androidApp 标题是否正确
- 146 版本以下，点击 【邀请好友免费听按钮】、【0 元领取按钮】、【点击分享记录图片】是否会弹出升级框；

## 2019 年 06 月 04 日

技术债：
埋点：添加 openId 为了记录 UV、封装按钮、图片等带有埋点组件
分享：解决遗留的 token 失效 bug、解决 test1 环境下分享数据请求失败的问题

待确定点：使用隐性授权获取 openId，页面会出现 2 次加载的情况，跟产品确定是否每个页面都得加？

埋点
影响范围：不影响功能、只添加 uid
测试点：选择售卖页，打开页面和任一年级购买按钮能看到 uid，证明 openId 添加成功
开发人员：何辉云

分享
影响范围：影响显示授权页面
测试点：对于添加了显性授权的页面，多人之间相互二次分享能授权成功
开发人员：宋乾

attach 在 div 上

## 2019 年 06 月 05 日

**任务：**

- 语文售卖二期更改文案、图片
- 语文售卖专区调整顺序
- 跟踪首页改版 bug，主要有授权页面错误、活动页的一些显示 bug
- 跟宋一起更新 ua 判断和与原生交互函数抽离

**踩坑：**

弹框滚动：

- ios 滚动上下会拉动（解决办法：滚动到底部和头，加 preventDefault，e.cancelable 不存在需要加上判断是否存在，注意，如果 Event 对象的 cancelable 属性是 fasle，那么就没有默认动作，或者不能阻止默认动作。）
- P3 安卓手机滑动失效，必须手不移开会有效

touch:
在 ios 中，在某一设备上打开链接，用 touchend 打开原生路由，会不生效，换成 click 可以（8p ，xmax）

- 监听 onscroll 不及时（在 onscroll 中设置的样式，在滚动过程中，会延迟执行）
- 需要特别注意 a 标签，a 标签的 href 也是 click，需要去掉换成 js 控制的跳转，或者直接改成 span + tap 控制跳转

video：

- 安卓默认样式不一样
- 安卓播放全屏失效（记录手机系统）
- 安卓点击播放，z-index 不生效
- ios 设置 playsinline 无效，依旧会全屏

http://coolcdn.igetcool.com/p/1559806888000.jpg

倒计时以正式上课时间为准
title 加正在直播

## 弹框组件思路

top 先在最底层，然后设置 bottom 为 0

语文专区体验及优化问题：

1. 底部浮框样式适配
   导致原因：因为给的按钮高度太高
   解决方案：替换图片

2. 点击按钮弹框出现卡顿现象，
   导致原因：因为按钮都是图片，需要请求时间
   解决方案：图片改成 html 和 css

3. android 平台，当滑动页面，视频控件抖动
   导致原因：不明
   解决方案：待调研

4. android 平台，视频退出全屏，页面没恢复到原滚动位置
   导致原因：不明
   解决方案：待调研

5. tab 图片替换

今天解决的问题：1、2、5
待解决，时间待定：3、4

附加新方案：为按钮添加 fastclick，提高点击速度

igetcool://juvenile.dedao.app/go/h5?params_url=https%3A%2F%2Figetcool-share-dev.igetcool.com%2FActive%2FchineseCourseSell%3Fh5Pid%3D100000000000000002%26t%3D2%26activityPid%3D336378080173252608&params_title=冬银测试—语文售卖页&enableShare=0&params_activities_uuid=336378080173252608&activityPid=336378080173252608&share_channels=0

igetcool://juvenile.dedao.app/go/h5?params_url=https%3A%2F%2Figetcool-share-dev.igetcool.com%2FActive%2FchineseCourseSell%3Fh5Pid%3D100000000000000002%26t%3D2%26activityPid%3D336378080173252608&params_title=&enableShare=0&params_activities_uuid=336378080173252608&activityPid=336378080173252608&share_channels=0

igetcool://juvenile.dedao.app/go/h5?params_url=https%3A%2F%2Figetcool-inset-dev.igetcool.com%2FActive%2FhomeActivity%3Fh5Pid%3D337849329797885952%26activityPid%3D319574292778676224&params_title=&enableShare=1&params_activities_uuid=319574292778676224&activityPid=319574292778676224&params_event=

igetcool://juvenile.dedao.app/go/h5?params_url=https%3A%2F%2Figetcool-share-dev.igetcool.com%2FActive%2FchineseCourseSell%3Fh5Pid%3D100000000000000002%26t%3D2%26activityPid%3D336378080173252608&params_title=&enableShare=0&params_activities_uuid=336378080173252608&activityPid=336378080173252608&share_channels=0

1. QQ 分享修复，多个活动页的分享是否能正常
2. 1 期语文售卖，老用户和新用户是否能正常跳转和购买
3. 2 期文售卖，老用户和新用户是否能正常跳转和购买
4. 底部按钮图片修改为样式
5. 头部悬浮按钮切换改为滚动
6. 底部弹出菜单添加动画
7. 安卓：改成登录进来刷新页面，解决登录进来第一次点击购买刷新页面的情况

安卓和 ios 端切换，要

丢包情况，要手动创建

干的活：

- 排查语文售卖页跳转到空白页、token 失效问题，并修复
- 优化语文售卖专区体验
- 公开课分享：需求评审、反述，20 号提测
- 新手礼包：19 号上线
- 组合购买图片样式优化
- 排查首页改版 H5 回归发现的几个小问题（qq 分享、标题显示、不同平台活动页图片显示）
- 埋点封装

cms:关联——加公开课列表；加上分享信息；预览需要更新（可能需要添加不同组件）

267791851390181376
http://test1-2.igetcool.com/course/live/findClassScheduleByClassId.json?courseId=267791851390181376&type=0&classId=272915959435182080&timeFrameId=272915752622440448

h5Pid=343548271725920256
activityPid=310571254771474432
创建小节，也就是创建一个活动

活动未开始，活动结束的状态

丁栏

6268055 111111 公众号账号
7 月份转走党组织
400800000

判断是否跳转走，就屏蔽

优惠券不支持叠加，不支持组合购买，以后可能支持

## 2019 年 06 月 24 日

财务需求：手动充值、手动购买、查询购买单：1 天
语文课换年级：1 天
优惠券：2 天
活动页关联优惠券：1 天
联调：3-4 天

新内容专题：1 天+1 天（联调)
占位图：确定哪几个图

6+（4~5）=10~11

4+3

## 2019 年 06 月 27 日

优惠券开始做了一部分
公开课分享
占位图技术调研

https://unpkg.com/wangeditor@3.1.1/release/wangEditor.min.js
https://www.kancloud.cn/wangfupeng/wangeditor3/335782
https://www.kancloud.cn/wangfupeng/wangeditor2/113975
https://github.com/wangfupeng1988/wangEditor/tree/v2
