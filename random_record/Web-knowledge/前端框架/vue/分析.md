## Vue 不能检测数组或对象变动问题的解决

https://blog.csdn.net/weixin_40260594/article/details/79079628

https://www.jb51.net/article/126756.htm

// this.audioPlay[key]=true; 这样写错误

## this 指向报错

```
Ios: function() {
       let that = this;
       if (window.navigator.userAgent.match(/APP_VERSION_NAME/i)) {
           that.userAgent = JSON.parse(window.navigator.userAgent)
           return that.userAgent.AGENT_WEB_VIEW == "igetios" ? true : false;
       }
   },
```

## mounted

mounted 获取不要直接获取动态标签，除非加上 nextClick
当异步请求数据，mounted 中获取不到数据

## package 中加上 node-sass 和 sass-loader，vue-cli 基础上就可以使用 sass（已经试过了，还可以继续验证）

## v-html

```
this.$nextTick(() => {
    let countTable = document.querySelector('.countTable');
    countTable.innerHTML=trs;
});
```

## vue 刷新当前路由

[参考链接](https://www.cnblogs.com/goloving/p/9005130.html)

## el-dropdown

@click="logout"这样写不行,后来发现需要在这样写  @click.native="logout"

```
 <el-dropdown>
          <i class="el-icon-setting" style="margin-right: 15px"></i>
          <el-dropdown-menu slot="dropdown">
            <el-dropdown-item>个人资料</el-dropdown-item>
            <el-dropdown-item @click.native="logout">退出</el-dropdown-item>
          </el-dropdown-menu>
 </el-dropdown>
```

## 写法

@click.native="(e) => essence(e, item)"
e 是可以获取 e.target，然后获取到元素
item 是额外传入的值
@click="essence(item)" 如果不用箭头函数，item 就是额外传入的值

## key 属性

自定义的组件一定要 key，如果需要 key，需要自己定义。(如果没有 key，会报提醒)

## 在 vue 中写法

import {Recorder} from "./record"
必须加上./，不然会找不到同目录下的文件

发现 slot 里的样式和组件中样式设置无效？

# 属性中加判断写法

```
<textarea :value="oneCommentInfo.commentBody ? oneCommentInfo.commentBody[0].content:''"></textarea>
```

## watch ，其中 answers 是属性

watch: {answers:function(v){
console.log(v)
}}

## 对象更新，来更新模板样式

经过实际测试：深层次对象赋值，不会更新模板样式。好的办法是定义单层对象

## 当打开 addHomeworkFormVisible 时，蒙层会出现闪一下（因为要 confirm 页面，再打开 addHomeworkFormVisible 页面。在做创建作业物料的时候碰到过）

```
this.$confirm("该作业已经有学员在使用了，仍然要改吗？", "", {
    confirmButtonText: "是的",
    cancelButtonText: "不改了",
    type: "warning"
}).then(() => {
    this.addHomeworkFormVisible = true;
    this.isEdit = true;
    oneHomeworkInfo(para).then(res => {
    if (res.code == 10000) {
        this.homeworkForm = res.data;
    }
    });
}).catch(() => {});
```

## computed

如果此函数中的任何一个变量发生变化，就会执行。

## 停止往下传播

```
v-on:click.stop
```

mouseover 使用此方法好像没有效果

## 类的写法

v-bind:class="[isShowHoverLayer ? 'show':'hide']"

发现在 css 中用 hover，不能正常有。操作想；；；显示和隐藏效果

## 多目运算符的写法

:style="item.backgroundImgUrl ? {'background-image': 'url('+item.backgroundImgUrl+')'}:''"

## 数组刷新

一级：this.isCheckPlay 是数组

```
this.$set(this.isCheckPlay,index,false);  有效果
// this.isCheckPlay[index] = false;  没效果
```

## 对象刷新

## 函数来返回值，用在模板中

```
<div v-for="(item,key,index) in form.points" v-bind:key="index"  class="dot-position" :style="thumbPercentage>getDotPosition(key)?{left:getDotPosition(key) +'%',borderColor:'#FFFFFF'}:{left:getDotPosition(key) +'%',borderColor:'#20A0FF'}">
</div>

getDotPosition(index){
    let startTimeEnd = Util.formatDate.dateToSecond(this.form.points[index].endTimeDot);
    let percentage = Math.ceil(100 * (startTimeEnd / this.audioDuration));
    return percentage
}
```

## 在 class 中加条件，因为 v-if 和 v-for 不能同时使用

```
<div v-for="(item,key,index) in form.points" v-bind:key="index"  :class="[positions[key]?'dot-position':'']"  :style=" thumbPercentage>positions[key]?{left:positions[key] +'%',borderColor:'#FFFFFF'}:{left:positions[key] +'%',borderColor:'#20A0FF'}  "  @click="(e)=>dotClick(e,key)" :data-anchor-id="'dot'+key">
```

## watch

```
  watch: {
    form: {
      handler: function(newValue,oldValue) {
      },
      deep: true
    }
  },
```

## popper-class 包含 2 个 class 写法，不能写成数组形式，否则会报错

```
<el-popover :popper-class="'reply-popover'+ ' ' +'relpy-key'+key+replyKey">   正确
<el-popover :popper-class="['reply-popover','relpy-key'+key+replyKey]">   错误
```

## 获取多个 popover 中被点击的 popover 思路

```
let value = '';
let replyPopovers = document.querySelectorAll('.reply-popover');
let target = e.target;
let clickedReplyId = target.getAttribute('aria-describedby')||target.parentNode.getAttribute('aria-describedby')
for(let i=0,len=replyPopovers.length;i<len;i++){
if(clickedReplyId === replyPopovers[i].getAttribute('id')){
    this.tempReplyInfos[key] = this.tempTextareaReplyValue;
}
}
```

## vue.runtime.esm.js?2b0e:205 Uncaught TypeError: fn.bind is not a function

发现 ：created ()包含在 method 中，再定一个 method 就会报错

## id 写在 item 下面，不然报错 id 没写，这个好奇怪

```
<configure-image
          :item="item"
          :id="key"
          ></configure-image>
```
## 全局组件引用和全局公共的js的引用
```
见messageBox组件方法
开发插件介绍：https://cn.vuejs.org/v2/guide/plugins.html
```
```
import {FromDates} from './api.js'
Vue.prototype.$fromdate = FromDates
到此,这种方法都可以使用了,终于不用在每个页面引用了
```

## .vue 和 .js
.vue文件中有template标签；
.js不能有，可以在对象中写template和render键

https://github.com/ElemeFE/element/blob/dev/packages/pagination/src/pagination.js 举例

定义组件时区分：Vue.extend(Pagination) 和 Vue.component(Pagination.name, Pagination);
```
import Pagination from './src/pagination';
Pagination.install = function(Vue) {
  Vue.component(Pagination.name, Pagination);
};

import msgboxVue from './messageBox.vue';

const MessageBox = {};
// vue的install方法，用于定义vue组件
MessageBox.install = function (Vue, options) {
  const MessageBoxInstance = Vue.extend(msgboxVue);
  let currentMsg, instance;
  const initInstance = () => {
    // 实例化vue实例
    currentMsg = new MessageBoxInstance();
    let msgBoxEl = currentMsg.$mount().$el;
    document.body.appendChild(msgBoxEl);
  };
  // 在Vue的原型上添加实例方法，以全局调用
  Vue.prototype.$msgBox = {}
};
```